# ëª©ë¡ ìƒì„¸ í™”ë©´ PRD

## 1. ê°œìš”

### 1.1 í™”ë©´ ëª©ì 
- ëª©ë¡ì— í¬í•¨ëœ ì¥ì†Œ ê´€ë¦¬
- ì¥ì†Œ ì¶”ê°€/ì œê±°
- ê²½ë¡œ ìµœì í™” ë° ì§„í–‰ë¥  ì¶”ì 

### 1.2 ì£¼ìš” ì‚¬ìš©ì í”Œë¡œìš°
```
ëª©ë¡ ìƒì„¸ â†’ ì¥ì†Œ ë¦¬ìŠ¤íŠ¸ â†’ ì¥ì†Œ ì„ íƒ â†’ ì¥ì†Œ ìƒì„¸
          â†“
          ì¥ì†Œ ì¶”ê°€ â†’ ê²€ìƒ‰/ì„ íƒ â†’ ì¶”ê°€
          ê²½ë¡œ ìµœì í™” â†’ ìˆœì„œ ì¡°ì •
```

### 1.3 ì„±ê³µ ì§€í‘œ
- ëª©ë¡ë‹¹ í‰ê·  ì¥ì†Œ: > 5ê°œ
- ê²½ë¡œ ìµœì í™” ì‚¬ìš©ë¥ : > 30%
- ì¥ì†Œ ë°©ë¬¸ ì™„ë£Œìœ¨: > 60%

## 2. ì‚¬ìš©ì ìŠ¤í† ë¦¬

### US-1: ì¥ì†Œ ë¦¬ìŠ¤íŠ¸ í™•ì¸
**As a** ì‚¬ìš©ì
**I want** ëª©ë¡ì— í¬í•¨ëœ ì¥ì†Œë¥¼ í•œëˆˆì— ë³´ê³  ì‹¶ë‹¤
**So that** ë°©ë¬¸ ê³„íšì„ ì„¸ìš¸ ìˆ˜ ìˆë‹¤

### US-2: ì¥ì†Œ ì¶”ê°€
**As a** ì‚¬ìš©ì
**I want** ëª©ë¡ì— ì¥ì†Œë¥¼ ì‰½ê²Œ ì¶”ê°€í•˜ê³  ì‹¶ë‹¤
**So that** í…Œë§ˆì— ë§ëŠ” ì¥ì†Œë¥¼ ëª¨ì„ ìˆ˜ ìˆë‹¤

### US-3: ê²½ë¡œ ìµœì í™”
**As a** ì‚¬ìš©ì
**I want** íš¨ìœ¨ì ì¸ ë°©ë¬¸ ìˆœì„œë¥¼ ì•Œê³  ì‹¶ë‹¤
**So that** ì‹œê°„ì„ ì ˆì•½í•  ìˆ˜ ìˆë‹¤

## 3. ê¸°ëŠ¥ ìš”êµ¬ì‚¬í•­

### 3.1 í•„ìˆ˜ ê¸°ëŠ¥ (Phase 1)

#### F-1: í—¤ë”
- [ ] ë’¤ë¡œê°€ê¸° ë²„íŠ¼
- [ ] ëª©ë¡ ì´ë¦„ (ì œëª©)
- [ ] ë”ë³´ê¸° ë©”ë‰´ (ìš°ì¸¡ ìƒë‹¨)
  - ëª©ë¡ í¸ì§‘
  - ëª©ë¡ ì‚­ì œ
  - ê³µìœ  (Phase 2)

#### F-2: ëª©ë¡ ì •ë³´ ì¹´ë“œ
- [ ] ì•„ì´ì½˜ (ì´ëª¨ì§€/ì´ë¯¸ì§€)
- [ ] ëª©ë¡ ì´ë¦„
- [ ] ì„¤ëª… (ìˆì„ ê²½ìš°)
- [ ] ì§„í–‰ë¥  ë°”
- [ ] í†µê³„:
  - ì´ ì¥ì†Œ ìˆ˜
  - ë°©ë¬¸ ì™„ë£Œ ìˆ˜
  - ë°©ë¬¸ë¥  (%)

**ë ˆì´ì•„ì›ƒ:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   ğŸ” ë§›ì§‘ íƒë°©   â”‚
â”‚  ì„œìš¸ ë§›ì§‘ ë¦¬ìŠ¤íŠ¸ â”‚
â”‚                 â”‚
â”‚  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘   â”‚
â”‚  8ê°œ ì¥ì†Œ Â· 6ê°œ ë°©ë¬¸â”‚
â”‚  75% ì™„ë£Œ       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### F-3: ë·° ì „í™˜ íƒ­
- [ ] ë¦¬ìŠ¤íŠ¸ ë·° (ê¸°ë³¸)
- [ ] ì§€ë„ ë·°

#### F-4: ì¥ì†Œ ë¦¬ìŠ¤íŠ¸ (ë¦¬ìŠ¤íŠ¸ ë·°)
- [ ] ì¥ì†Œ ì¹´ë“œ:
  - ì¹´í…Œê³ ë¦¬ ì•„ì´ì½˜
  - ì¥ì†Œëª…
  - ì£¼ì†Œ (1ì¤„)
  - ë°©ë¬¸ ì—¬ë¶€ ì²´í¬ë°•ìŠ¤
  - ë”ë³´ê¸° ë²„íŠ¼ (â‹®)
- [ ] ì •ë ¬ ì˜µì…˜:
  - ì¶”ê°€í•œ ìˆœì„œ (ê¸°ë³¸)
  - ì´ë¦„ìˆœ
  - ê±°ë¦¬ìˆœ (í˜„ì¬ ìœ„ì¹˜ ê¸°ì¤€)
  - ì¹´í…Œê³ ë¦¬ìˆœ

**ì¥ì†Œ ì¹´ë“œ ë ˆì´ì•„ì›ƒ:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â˜ ğŸ ë§›ì§‘ A     â‹® â”‚
â”‚    ì„œìš¸ ê°•ë‚¨êµ¬       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**API ìš”ì²­:**
```typescript
GET /api/lists/:id/places?sort=order

Response 200:
{
  places: [
    {
      id: string;
      name: string;
      address: string;
      category: string;
      visited: boolean;
      latitude: number;
      longitude: number;
      order: number; // ëª©ë¡ ë‚´ ìˆœì„œ
    }
  ]
}
```

#### F-5: ì¥ì†Œ ì¹´ë“œ ì•¡ì…˜
- [ ] íƒ­: ì¥ì†Œ ìƒì„¸ í™”ë©´ ì´ë™
- [ ] ì²´í¬ë°•ìŠ¤: ë°©ë¬¸ ì—¬ë¶€ í† ê¸€
- [ ] ë”ë³´ê¸°:
  - ëª©ë¡ì—ì„œ ì œê±°
  - ì¥ì†Œ ìƒì„¸ë¡œ ì´ë™

**ì²´í¬ë°•ìŠ¤ í† ê¸€:**
```typescript
PATCH /api/places/:id
{
  visited: boolean;
}

Response 200:
{
  id: string;
  visited: boolean;
  visitedAt: Date | null;
}
```

**ëª©ë¡ì—ì„œ ì œê±°:**
```typescript
DELETE /api/lists/:listId/places/:placeId

Response 204: No Content
```

#### F-6: ì§€ë„ ë·°
- [ ] ëª©ë¡ ë‚´ ì¥ì†Œ ë§ˆì»¤ í‘œì‹œ
- [ ] ë§ˆì»¤ í´ë¦­ â†’ InfoWindow
- [ ] í˜„ì¬ ìœ„ì¹˜ í‘œì‹œ
- [ ] ë°©ë¬¸/ë¯¸ë°©ë¬¸ ìƒ‰ìƒ êµ¬ë¶„

#### F-7: ì¥ì†Œ ì¶”ê°€ ë²„íŠ¼
- [ ] í”Œë¡œíŒ… "+" ë²„íŠ¼ (ìš°ì¸¡ í•˜ë‹¨)
- [ ] íƒ­ ì‹œ ì¥ì†Œ ì¶”ê°€ ëª¨ë‹¬

#### F-8: ì¥ì†Œ ì¶”ê°€ ëª¨ë‹¬
- [ ] íƒ­ 1: ê²€ìƒ‰
  - ê²€ìƒ‰ ë°”
  - ê²€ìƒ‰ ê²°ê³¼ ë¦¬ìŠ¤íŠ¸
  - ê²°ê³¼ ì„ íƒ â†’ ì¶”ê°€
- [ ] íƒ­ 2: ë‚´ ì¥ì†Œ
  - ì „ì²´ ì¥ì†Œ ë¦¬ìŠ¤íŠ¸
  - ì´ë¯¸ ì¶”ê°€ëœ ì¥ì†Œ í‘œì‹œ
  - ì„ íƒ â†’ ì¶”ê°€

**ì¥ì†Œ ì¶”ê°€ API:**
```typescript
POST /api/lists/:listId/places
{
  placeIds: string[];
}

Response 200:
{
  added: number;
  places: Place[];
}
```

### 3.2 ì¤‘ìš” ê¸°ëŠ¥ (Phase 2)

#### F-9: ê²½ë¡œ ìµœì í™”
- [ ] "ê²½ë¡œ ìµœì í™”" ë²„íŠ¼
- [ ] ìµœì í™” ì•Œê³ ë¦¬ì¦˜:
  - í˜„ì¬ ìœ„ì¹˜ ê¸°ì¤€ (ì‹œì‘ì )
  - ë¯¸ë°©ë¬¸ ì¥ì†Œë§Œ ë˜ëŠ” ì „ì²´
  - TSP (Traveling Salesman Problem) ê·¼ì‚¬ ì•Œê³ ë¦¬ì¦˜
- [ ] ìµœì í™”ëœ ìˆœì„œ í‘œì‹œ
- [ ] "ì ìš©" ë²„íŠ¼ â†’ ìˆœì„œ ì €ì¥

**ê²½ë¡œ ìµœì í™” API:**
```typescript
POST /api/lists/:id/optimize-route
{
  startLocation: { lat: number; lng: number };
  includeVisited: boolean;
}

Response 200:
{
  optimizedOrder: {
    placeId: string;
    order: number;
    distance: number; // ì´ì „ ì¥ì†Œë¡œë¶€í„° ê±°ë¦¬ (m)
  }[];
  totalDistance: number; // ì´ ê±°ë¦¬ (m)
  estimatedTime: number; // ì˜ˆìƒ ì†Œìš” ì‹œê°„ (ë¶„)
}
```

**ê²½ë¡œ ìµœì í™” ì•Œê³ ë¦¬ì¦˜ (ê°„ë‹¨í•œ Nearest Neighbor):**
```typescript
function optimizeRoute(
  places: Place[],
  startLocation: Location
): OptimizedRoute {
  const unvisited = [...places];
  const route: PlaceWithDistance[] = [];
  let currentLocation = startLocation;
  let totalDistance = 0;

  while (unvisited.length > 0) {
    // ê°€ì¥ ê°€ê¹Œìš´ ì¥ì†Œ ì°¾ê¸°
    let nearestIndex = 0;
    let nearestDistance = calculateDistance(
      currentLocation,
      unvisited[0]
    );

    for (let i = 1; i < unvisited.length; i++) {
      const distance = calculateDistance(
        currentLocation,
        unvisited[i]
      );
      if (distance < nearestDistance) {
        nearestDistance = distance;
        nearestIndex = i;
      }
    }

    const nearest = unvisited.splice(nearestIndex, 1)[0];
    route.push({
      ...nearest,
      order: route.length,
      distance: nearestDistance
    });

    currentLocation = {
      latitude: nearest.latitude,
      longitude: nearest.longitude
    };
    totalDistance += nearestDistance;
  }

  return {
    optimizedOrder: route,
    totalDistance,
    estimatedTime: Math.ceil((totalDistance / 1000) * 12) // 1kmë‹¹ 12ë¶„ ê°€ì •
  };
}

function calculateDistance(
  a: { latitude: number; longitude: number },
  b: { latitude: number; longitude: number }
): number {
  // Haversine ê³µì‹
  const R = 6371e3; // ì§€êµ¬ ë°˜ì§€ë¦„ (m)
  const Ï†1 = (a.latitude * Math.PI) / 180;
  const Ï†2 = (b.latitude * Math.PI) / 180;
  const Î”Ï† = ((b.latitude - a.latitude) * Math.PI) / 180;
  const Î”Î» = ((b.longitude - a.longitude) * Math.PI) / 180;

  const x =
    Math.sin(Î”Ï† / 2) * Math.sin(Î”Ï† / 2) +
    Math.cos(Ï†1) * Math.cos(Ï†2) * Math.sin(Î”Î» / 2) * Math.sin(Î”Î» / 2);
  const c = 2 * Math.atan2(Math.sqrt(x), Math.sqrt(1 - x));

  return R * c;
}
```

#### F-10: ìˆœì„œ ë³€ê²½ (ë“œë˜ê·¸ ì•¤ ë“œë¡­)
- [ ] ì¥ì†Œ ì¹´ë“œ ë¡±í”„ë ˆìŠ¤ â†’ ë“œë˜ê·¸ ëª¨ë“œ
- [ ] ë“œë˜ê·¸í•˜ì—¬ ìˆœì„œ ë³€ê²½
- [ ] ìˆœì„œ ìë™ ì €ì¥

#### F-11: ì²´í¬ë¦¬ìŠ¤íŠ¸ ëª¨ë“œ
- [ ] í—¤ë”ì— "ì²´í¬ë¦¬ìŠ¤íŠ¸" í† ê¸€
- [ ] í™œì„±í™” ì‹œ:
  - ê°„ì†Œí™”ëœ UI
  - í° ì²´í¬ë°•ìŠ¤
  - ë°©ë¬¸ ì™„ë£Œ ì¥ì†Œ íë¦¬ê²Œ í‘œì‹œ or ìˆ¨ê¸°ê¸°

#### F-12: ì˜ˆìƒ ì†Œìš” ì‹œê°„
- [ ] ë¯¸ë°©ë¬¸ ì¥ì†Œ ê¸°ì¤€
- [ ] ì´ë™ ì‹œê°„ + ì²´ë¥˜ ì‹œê°„
- [ ] "ì´ {ì‹œê°„}ì‹œê°„ {ë¶„}ë¶„ ì˜ˆìƒ" í‘œì‹œ

### 3.3 ì¶”ê°€ ê¸°ëŠ¥ (Phase 3)

#### F-13: PDF ë‚´ë³´ë‚´ê¸°
- [ ] ëª©ë¡ì„ PDFë¡œ ë‚´ë³´ë‚´ê¸°
- [ ] í¬í•¨ ë‚´ìš©:
  - ëª©ë¡ ì •ë³´
  - ì¥ì†Œ ë¦¬ìŠ¤íŠ¸
  - ì§€ë„ ì´ë¯¸ì§€
  - QR ì½”ë“œ (ê³µìœ  ë§í¬)

#### F-14: ì¼ì • ìº˜ë¦°ë” ì—°ë™
- [ ] íŠ¹ì • ë‚ ì§œì— ëª©ë¡ ì—°ê²°
- [ ] ìº˜ë¦°ë” ì•± ì—°ë™ (Google Calendar ë“±)

#### F-15: ì´ë™ ìˆ˜ë‹¨ í‘œì‹œ
- [ ] ì¥ì†Œ ê°„ ì´ë™ ìˆ˜ë‹¨ (ë„ë³´/ëŒ€ì¤‘êµí†µ/ìë™ì°¨)
- [ ] ì˜ˆìƒ ì´ë™ ì‹œê°„
- [ ] ê²½ë¡œ ì•ˆë‚´ ë§í¬

## 4. UI/UX ì‚¬ì–‘

### 4.1 ë ˆì´ì•„ì›ƒ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  â†  ë§›ì§‘ íƒë°©    â‹®   â”‚ í—¤ë”
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ” ë§›ì§‘ íƒë°©        â”‚ ëª©ë¡ ì •ë³´
â”‚  ì„œìš¸ ë§›ì§‘ ë¦¬ìŠ¤íŠ¸     â”‚
â”‚  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘       â”‚
â”‚  8ê°œ Â· 6/8 (75%)   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ [ë¦¬ìŠ¤íŠ¸] [ì§€ë„]      â”‚ ë·° ì „í™˜ íƒ­
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ì •ë ¬: ìˆœì„œ  â–¼       â”‚ ì •ë ¬ ì˜µì…˜
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ â˜ ğŸ ë§›ì§‘ A  â‹®â”‚ â”‚
â”‚ â”‚   ì„œìš¸ ê°•ë‚¨êµ¬    â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ â˜‘ â˜• ì¹´í˜ B  â‹®â”‚ â”‚
â”‚ â”‚   ì„œìš¸ ê°•ë‚¨êµ¬    â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                     â”‚
â”‚              [  +  ]â”‚ í”Œë¡œíŒ… ë²„íŠ¼
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4.2 ì¸í„°ë™ì…˜

#### ì¥ì†Œ ì¹´ë“œ
- íƒ­: ì¥ì†Œ ìƒì„¸
- ì²´í¬ë°•ìŠ¤: ë°©ë¬¸ í† ê¸€ (ë‚™ê´€ì  UI)
- ë¡±í”„ë ˆìŠ¤: ë“œë˜ê·¸ ëª¨ë“œ

#### ë“œë˜ê·¸ ì•¤ ë“œë¡­
- ë¡±í”„ë ˆìŠ¤: ì¹´ë“œ ë“¤ì–´ì˜¬ë¦¼ íš¨ê³¼
- ë“œë˜ê·¸: ë‹¤ë¥¸ ì¹´ë“œë“¤ ì´ë™
- ë“œë¡­: ìˆœì„œ ì €ì¥

#### ê²½ë¡œ ìµœì í™”
- ë²„íŠ¼ íƒ­: ê³„ì‚° ë¡œë”©
- ê²°ê³¼ í‘œì‹œ: ìˆœì„œ ë³€ê²½ ì• ë‹ˆë©”ì´ì…˜
- ì ìš©: ìˆœì„œ ì €ì¥

### 4.3 ì ‘ê·¼ì„±
- ì¥ì†Œ ì¹´ë“œ: ì „ì²´ ë‚´ìš© ì½ê¸°
- ì²´í¬ë°•ìŠ¤: ìƒíƒœ ì•Œë¦¼
- ë“œë˜ê·¸: í‚¤ë³´ë“œ ëŒ€ì²´ (ìœ„/ì•„ë˜ ë²„íŠ¼)

## 5. ê¸°ìˆ  ì‚¬ì–‘

### 5.1 í”„ë¡ íŠ¸ì—”ë“œ

#### ì»´í¬ë„ŒíŠ¸ êµ¬ì¡°
```typescript
// ListDetailScreen.tsx
interface ListDetailScreenProps {
  listId: string;
}

interface ListDetailState {
  list: List | null;
  places: Place[];
  viewMode: 'list' | 'map';
  sortBy: 'order' | 'name' | 'distance' | 'category';
  isOptimizing: boolean;
  isChecklistMode: boolean;
}

// PlaceListItem.tsx
interface PlaceListItemProps {
  place: Place;
  order: number;
  onPress: (id: string) => void;
  onToggleVisit: (id: string, visited: boolean) => void;
  onRemove: (id: string) => void;
  isDraggable: boolean;
}

// AddPlaceModal.tsx
interface AddPlaceModalProps {
  isOpen: boolean;
  listId: string;
  existingPlaceIds: string[];
  onClose: () => void;
  onAdd: (placeIds: string[]) => void;
}

// RouteOptimizer.tsx
interface RouteOptimizerProps {
  places: Place[];
  onApply: (optimizedOrder: PlaceOrder[]) => void;
}
```

#### ë“œë˜ê·¸ ì•¤ ë“œë¡­ (react-beautiful-dnd ì‚¬ìš©)
```typescript
import { DragDropContext, Droppable, Draggable } from 'react-beautiful-dnd';

function PlaceList({ places, onReorder }: PlaceListProps) {
  const handleDragEnd = (result: DropResult) => {
    if (!result.destination) return;

    const items = Array.from(places);
    const [reordered] = items.splice(result.source.index, 1);
    items.splice(result.destination.index, 0, reordered);

    // ìˆœì„œ ì—…ë°ì´íŠ¸
    const updates = items.map((place, index) => ({
      placeId: place.id,
      order: index
    }));

    onReorder(updates);
  };

  return (
    <DragDropContext onDragEnd={handleDragEnd}>
      <Droppable droppableId="places">
        {(provided) => (
          <div {...provided.droppableProps} ref={provided.innerRef}>
            {places.map((place, index) => (
              <Draggable
                key={place.id}
                draggableId={place.id}
                index={index}
              >
                {(provided) => (
                  <div
                    ref={provided.innerRef}
                    {...provided.draggableProps}
                    {...provided.dragHandleProps}
                  >
                    <PlaceListItem place={place} order={index} />
                  </div>
                )}
              </Draggable>
            ))}
            {provided.placeholder}
          </div>
        )}
      </Droppable>
    </DragDropContext>
  );
}
```

### 5.2 ë°±ì—”ë“œ

#### API ì—”ë“œí¬ì¸íŠ¸
```typescript
// lists.controller.ts
@Controller('lists')
export class ListsController {
  @Get(':id/places')
  async getListPlaces(
    @CurrentUser() user: User,
    @Param('id') listId: string,
    @Query('sort') sort: string = 'order'
  ) {
    return this.listsService.getPlaces(user.id, listId, { sort });
  }

  @Post(':id/places')
  async addPlaces(
    @CurrentUser() user: User,
    @Param('id') listId: string,
    @Body() dto: AddPlacesDto
  ) {
    return this.listsService.addPlaces(user.id, listId, dto.placeIds);
  }

  @Delete(':listId/places/:placeId')
  @HttpCode(204)
  async removePlace(
    @CurrentUser() user: User,
    @Param('listId') listId: string,
    @Param('placeId') placeId: string
  ) {
    await this.listsService.removePlace(user.id, listId, placeId);
  }

  @Patch(':id/places/reorder')
  async reorderPlaces(
    @CurrentUser() user: User,
    @Param('id') listId: string,
    @Body() dto: ReorderPlacesDto
  ) {
    return this.listsService.reorderPlaces(user.id, listId, dto.order);
  }

  @Post(':id/optimize-route')
  async optimizeRoute(
    @CurrentUser() user: User,
    @Param('id') listId: string,
    @Body() dto: OptimizeRouteDto
  ) {
    return this.listsService.optimizeRoute(
      user.id,
      listId,
      dto.startLocation,
      dto.includeVisited
    );
  }
}

// add-places.dto.ts
export class AddPlacesDto {
  @IsArray()
  @IsString({ each: true })
  placeIds: string[];
}

// reorder-places.dto.ts
export class ReorderPlacesDto {
  @IsArray()
  @ValidateNested({ each: true })
  @Type(() => PlaceOrderDto)
  order: PlaceOrderDto[];
}

export class PlaceOrderDto {
  @IsString()
  placeId: string;

  @IsNumber()
  @Min(0)
  order: number;
}

// optimize-route.dto.ts
export class OptimizeRouteDto {
  @ValidateNested()
  @Type(() => LocationDto)
  startLocation: LocationDto;

  @IsBoolean()
  includeVisited: boolean;
}

export class LocationDto {
  @IsNumber()
  @Min(-90)
  @Max(90)
  latitude: number;

  @IsNumber()
  @Min(-180)
  @Max(180)
  longitude: number;
}
```

## 6. ë°ì´í„° ëª¨ë¸

### 6.1 PlaceList (ì—°ê²° í…Œì´ë¸” í™•ì¥)
```typescript
interface PlaceList {
  id: string;
  placeId: string;
  listId: string;
  order: number; // ëª©ë¡ ë‚´ ìˆœì„œ
  addedAt: Date;
}
```

## 7. API ëª…ì„¸

### GET /api/lists/:id/places
ëª©ë¡ ë‚´ ì¥ì†Œ ì¡°íšŒ

**Query Params:**
- `sort`: order, name, distance, category

**Response 200:**
```json
{
  "places": [
    {
      "id": "uuid-1",
      "name": "ë§›ì§‘ A",
      "address": "ì„œìš¸ ê°•ë‚¨êµ¬",
      "category": "restaurant",
      "visited": false,
      "latitude": 37.5,
      "longitude": 127.0,
      "order": 0
    }
  ]
}
```

### POST /api/lists/:id/places
ì¥ì†Œ ì¶”ê°€

**Request:**
```json
{
  "placeIds": ["uuid-1", "uuid-2"]
}
```

**Response 200:**
```json
{
  "added": 2,
  "places": [...]
}
```

### PATCH /api/lists/:id/places/reorder
ìˆœì„œ ë³€ê²½

**Request:**
```json
{
  "order": [
    { "placeId": "uuid-1", "order": 0 },
    { "placeId": "uuid-2", "order": 1 }
  ]
}
```

**Response 200:**
```json
{
  "updated": 2
}
```

### POST /api/lists/:id/optimize-route
ê²½ë¡œ ìµœì í™”

**Request:**
```json
{
  "startLocation": {
    "latitude": 37.5665,
    "longitude": 126.9780
  },
  "includeVisited": false
}
```

**Response 200:**
```json
{
  "optimizedOrder": [
    {
      "placeId": "uuid-1",
      "order": 0,
      "distance": 1500
    }
  ],
  "totalDistance": 5000,
  "estimatedTime": 60
}
```

## 8. ì„±ëŠ¥ ìš”êµ¬ì‚¬í•­

### 8.1 ë¡œë”© ì‹œê°„
- ì¥ì†Œ ë¦¬ìŠ¤íŠ¸: < 500ms
- ì§€ë„ ë Œë”ë§: < 1ì´ˆ
- ê²½ë¡œ ìµœì í™”: < 2ì´ˆ

### 8.2 ìµœì í™”
- ì¥ì†Œ ìˆ˜ > 100: ê°€ìƒí™” ìŠ¤í¬ë¡¤
- ë“œë˜ê·¸: 60fps ìœ ì§€
- ì§€ë„: ë§ˆì»¤ í´ëŸ¬ìŠ¤í„°ë§

## 9. ë³´ì•ˆ ê³ ë ¤ì‚¬í•­

### 9.1 ê¶Œí•œ ê²€ì¦
- ë³¸ì¸ ëª©ë¡ë§Œ ì¡°íšŒ/ìˆ˜ì •
- ì¥ì†Œ ì¶”ê°€ ì‹œ ì¡´ì¬ ì—¬ë¶€ í™•ì¸

## 10. í…ŒìŠ¤íŠ¸ ê³„íš

### 10.1 Unit í…ŒìŠ¤íŠ¸
```typescript
describe('ListDetailScreen', () => {
  it('ì¥ì†Œ ë¦¬ìŠ¤íŠ¸ í‘œì‹œ', () => {
    // í…ŒìŠ¤íŠ¸ ì½”ë“œ
  });

  it('ë°©ë¬¸ ì—¬ë¶€ í† ê¸€', async () => {
    // í…ŒìŠ¤íŠ¸ ì½”ë“œ
  });

  it('ìˆœì„œ ë³€ê²½', async () => {
    // í…ŒìŠ¤íŠ¸ ì½”ë“œ
  });

  it('ê²½ë¡œ ìµœì í™”', async () => {
    // í…ŒìŠ¤íŠ¸ ì½”ë“œ
  });
});
```

### 10.2 E2E ì‹œë‚˜ë¦¬ì˜¤
1. ëª©ë¡ ìƒì„¸ ì§„ì… â†’ ì¥ì†Œ ë¦¬ìŠ¤íŠ¸ í™•ì¸
2. ì¥ì†Œ ì¶”ê°€ â†’ ê²€ìƒ‰ â†’ ì„ íƒ â†’ ì¶”ê°€
3. ì²´í¬ë°•ìŠ¤ í† ê¸€ â†’ ë°©ë¬¸ ì™„ë£Œ
4. ê²½ë¡œ ìµœì í™” â†’ ì ìš©

## 11. í–¥í›„ ê°œì„ ì‚¬í•­

### 11.1 UX ê°œì„ 
- ì¼ê´„ ì²´í¬/í•´ì œ
- ì¥ì†Œ í•„í„°ë§
- ìŠ¤ì™€ì´í”„ ì•¡ì…˜

### 11.2 ê¸°ëŠ¥ í™•ì¥
- ì¼ì • ëª¨ë“œ (ë‚ ì§œë³„ ë¶„ë¥˜)
- ë¹„ìš© ì§‘ê³„
- ì²´ë¥˜ ì‹œê°„ ì„¤ì •

### 11.3 ê³µìœ 
- ì‹¤ì‹œê°„ í˜‘ì—…
- ì¹œêµ¬ì™€ ì§„í–‰ë¥  ê³µìœ 
- ì¶”ì²œ ë°›ê¸°
