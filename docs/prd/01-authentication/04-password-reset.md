# ë¹„ë°€ë²ˆí˜¸ ì¬ì„¤ì • í™”ë©´ PRD

## 1. ê°œìš”

### 1.1 í™”ë©´ ëª©ì 
- ë¹„ë°€ë²ˆí˜¸ë¥¼ ìŠì€ ì‚¬ìš©ìì˜ ê³„ì • ë³µêµ¬
- ì•ˆì „í•œ ë¹„ë°€ë²ˆí˜¸ ì¬ì„¤ì • í”„ë¡œì„¸ìŠ¤
- ê³„ì • ë³´ì•ˆ ìœ ì§€

### 1.2 ì£¼ìš” ì‚¬ìš©ì í”Œë¡œìš°
```
ë¹„ë°€ë²ˆí˜¸ ì°¾ê¸° â†’ ì´ë©”ì¼ ì…ë ¥ â†’ ì¸ì¦ ë©”ì¼ ë°œì†¡ â†’ ì´ë©”ì¼ ë§í¬ í´ë¦­ â†’
ìƒˆ ë¹„ë°€ë²ˆí˜¸ ì„¤ì • â†’ ì¬ì„¤ì • ì™„ë£Œ â†’ ë¡œê·¸ì¸
```

### 1.3 ì„±ê³µ ì§€í‘œ
- ì¬ì„¤ì • ì™„ë£Œìœ¨: > 80%
- ì´ë©”ì¼ ë„ë‹¬ë¥ : > 95%
- í‰ê·  ë³µêµ¬ ì‹œê°„: < 5ë¶„

## 2. ì‚¬ìš©ì ìŠ¤í† ë¦¬

### US-1: ë¹„ë°€ë²ˆí˜¸ ì°¾ê¸°
**As a** ë¹„ë°€ë²ˆí˜¸ë¥¼ ìŠì€ ì‚¬ìš©ì
**I want** ì´ë©”ì¼ì„ í†µí•´ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì¬ì„¤ì •í•˜ê³  ì‹¶ë‹¤
**So that** ë‹¤ì‹œ ë¡œê·¸ì¸í•  ìˆ˜ ìˆë‹¤

### US-2: ì¬ì„¤ì • ë§í¬
**As a** ì‚¬ìš©ì
**I want** ì´ë©”ì¼ë¡œ ë°›ì€ ë§í¬ë¥¼ í´ë¦­í•˜ê³  ì‹¶ë‹¤
**So that** ì•ˆì „í•˜ê²Œ ë¹„ë°€ë²ˆí˜¸ë¥¼ ë³€ê²½í•  ìˆ˜ ìˆë‹¤

### US-3: ë³´ì•ˆ í™•ì¸
**As a** ì‚¬ìš©ì
**I want** ì¬ì„¤ì • ë§í¬ê°€ ì•ˆì „í•˜ê²Œ ê´€ë¦¬ë˜ê¸¸ ì›í•œë‹¤
**So that** ë‚´ ê³„ì •ì´ ë³´í˜¸ë°›ì„ ìˆ˜ ìˆë‹¤

## 3. ê¸°ëŠ¥ ìš”êµ¬ì‚¬í•­

### 3.1 í•„ìˆ˜ ê¸°ëŠ¥ (Phase 1)

#### F-1: ì´ë©”ì¼ ì…ë ¥ í™”ë©´
- [ ] ì´ë©”ì¼ ì…ë ¥ í•„ë“œ
- [ ] ì´ë©”ì¼ í˜•ì‹ ê²€ì¦
- [ ] "ì¬ì„¤ì • ë§í¬ ë³´ë‚´ê¸°" ë²„íŠ¼
- [ ] ë’¤ë¡œê°€ê¸° â†’ ë¡œê·¸ì¸ í™”ë©´

**API ìš”ì²­:**
```typescript
POST /api/auth/request-password-reset
{
  email: string;
}

Response 200:
{
  message: "ë¹„ë°€ë²ˆí˜¸ ì¬ì„¤ì • ë§í¬ê°€ ì´ë©”ì¼ë¡œ ì „ì†¡ë˜ì—ˆìŠµë‹ˆë‹¤";
  email: string; // ë§ˆìŠ¤í‚¹ëœ ì´ë©”ì¼ (u***@example.com)
}

Response 404:
{
  error: "EMAIL_NOT_FOUND";
  message: "ë“±ë¡ë˜ì§€ ì•Šì€ ì´ë©”ì¼ì…ë‹ˆë‹¤";
}

// ë³´ì•ˆ: ì´ë©”ì¼ ì¡´ì¬ ì—¬ë¶€ì™€ ê´€ê³„ì—†ì´ í•­ìƒ 200 ë°˜í™˜ (ì„ íƒ)
Response 200:
{
  message: "ì…ë ¥í•˜ì‹  ì´ë©”ì¼ë¡œ ì¬ì„¤ì • ë§í¬ë¥¼ ë°œì†¡í–ˆìŠµë‹ˆë‹¤";
}
```

**ì˜ˆì™¸ ì²˜ë¦¬:**
- ë¯¸ë“±ë¡ ì´ë©”ì¼: "ì…ë ¥í•˜ì‹  ì´ë©”ì¼ë¡œ ì¬ì„¤ì • ë§í¬ë¥¼ ë°œì†¡í–ˆìŠµë‹ˆë‹¤" (ë³´ì•ˆ)
- ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜: "ë„¤íŠ¸ì›Œí¬ ì—°ê²°ì„ í™•ì¸í•´ì£¼ì„¸ìš”"
- ì„œë²„ ì˜¤ë¥˜: "ì¼ì‹œì ì¸ ì˜¤ë¥˜ì…ë‹ˆë‹¤. ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”"

#### F-2: ì´ë©”ì¼ ë°œì†¡ í™•ì¸ í™”ë©´
- [ ] ë°œì†¡ ì™„ë£Œ ë©”ì‹œì§€
- [ ] ë§ˆìŠ¤í‚¹ëœ ì´ë©”ì¼ í‘œì‹œ
- [ ] ì•ˆë‚´ ë¬¸êµ¬
  - "ë©”ì¼ì´ ë„ì°©í•˜ì§€ ì•Šì•˜ë‚˜ìš”?"
  - "ìŠ¤íŒ¸ ë©”ì¼í•¨ì„ í™•ì¸í•´ì£¼ì„¸ìš”"
  - "1ë¶„ í›„ì— ì¬ë°œì†¡í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤"
- [ ] ì¬ë°œì†¡ ë²„íŠ¼ (ì¿¨ë‹¤ìš´ 60ì´ˆ)
- [ ] ë¡œê·¸ì¸ í™”ë©´ìœ¼ë¡œ ëŒì•„ê°€ê¸°

#### F-3: ì¬ì„¤ì • ë§í¬ ì´ë©”ì¼
```
ì œëª©: [Travel Planner] ë¹„ë°€ë²ˆí˜¸ ì¬ì„¤ì • ì•ˆë‚´

ì•ˆë…•í•˜ì„¸ìš”,

ë¹„ë°€ë²ˆí˜¸ ì¬ì„¤ì •ì„ ìš”ì²­í•˜ì…¨ìŠµë‹ˆë‹¤.
ì•„ë˜ ë²„íŠ¼ì„ í´ë¦­í•˜ì—¬ ìƒˆ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì„¤ì •í•´ì£¼ì„¸ìš”.

[ë¹„ë°€ë²ˆí˜¸ ì¬ì„¤ì •í•˜ê¸°]
{resetLink}

ë§í¬ëŠ” 1ì‹œê°„ ë™ì•ˆ ìœ íš¨í•©ë‹ˆë‹¤.

ë³¸ì¸ì´ ìš”ì²­í•˜ì§€ ì•Šì•˜ë‹¤ë©´ ì´ ë©”ì¼ì„ ë¬´ì‹œí•´ì£¼ì„¸ìš”.
ê³„ì •ì€ ì•ˆì „í•˜ê²Œ ë³´í˜¸ë˜ê³  ìˆìŠµë‹ˆë‹¤.

ë¬¸ì˜ì‚¬í•­ì´ ìˆìœ¼ì‹œë©´ ê³ ê°ì„¼í„°ë¡œ ì—°ë½ ì£¼ì„¸ìš”.
```

#### F-4: ìƒˆ ë¹„ë°€ë²ˆí˜¸ ì„¤ì • í™”ë©´
- [ ] ìƒˆ ë¹„ë°€ë²ˆí˜¸ ì…ë ¥ í•„ë“œ
- [ ] ë¹„ë°€ë²ˆí˜¸ í™•ì¸ í•„ë“œ
- [ ] ë¹„ë°€ë²ˆí˜¸ ê°•ë„ í‘œì‹œ
- [ ] í‘œì‹œ/ìˆ¨ê¹€ í† ê¸€
- [ ] "ë¹„ë°€ë²ˆí˜¸ ì¬ì„¤ì •" ë²„íŠ¼

**í† í° ê²€ì¦:**
- URL íŒŒë¼ë¯¸í„°ë¡œ í† í° ì „ë‹¬
- í† í° ìœ íš¨ì„± í™•ì¸ (ë§Œë£Œ, ì‚¬ìš© ì—¬ë¶€)
- ìœ íš¨í•˜ì§€ ì•Šì€ í† í°: ì—ëŸ¬ í™”ë©´ í‘œì‹œ

**API ìš”ì²­:**
```typescript
POST /api/auth/reset-password
{
  token: string;
  newPassword: string;
}

Response 200:
{
  message: "ë¹„ë°€ë²ˆí˜¸ê°€ ì„±ê³µì ìœ¼ë¡œ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤";
}

Response 400:
{
  error: "INVALID_TOKEN";
  message: "ìœ íš¨í•˜ì§€ ì•Šê±°ë‚˜ ë§Œë£Œëœ ë§í¬ì…ë‹ˆë‹¤";
}

Response 400:
{
  error: "WEAK_PASSWORD";
  message: "ë” ê°•ë ¥í•œ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì„¤ì •í•´ì£¼ì„¸ìš”";
}
```

**ë¹„ë°€ë²ˆí˜¸ ìš”êµ¬ì‚¬í•­:**
- ìµœì†Œ 8ì
- ì˜ë¬¸ ëŒ€ì†Œë¬¸ì + ìˆ«ì ì¡°í•©
- ì´ì „ ë¹„ë°€ë²ˆí˜¸ì™€ ë‹¤ë¦„
- í”í•œ ë¹„ë°€ë²ˆí˜¸ ê¸ˆì§€ (password123 ë“±)

#### F-5: ì¬ì„¤ì • ì™„ë£Œ í™”ë©´
- [ ] ì„±ê³µ ë©”ì‹œì§€
- [ ] "ë¡œê·¸ì¸í•˜ê¸°" ë²„íŠ¼
- [ ] ìë™ ë¦¬ë‹¤ì´ë ‰íŠ¸ (3ì´ˆ í›„)

#### F-6: ì—ëŸ¬ í™”ë©´
- [ ] ë§Œë£Œëœ ë§í¬ ì•ˆë‚´
- [ ] "ì¬ì„¤ì • ë‹¤ì‹œ ìš”ì²­í•˜ê¸°" ë²„íŠ¼
- [ ] ë¡œê·¸ì¸ í™”ë©´ ë§í¬

### 3.2 ì¤‘ìš” ê¸°ëŠ¥ (Phase 2)

#### F-7: ì¬ë°œì†¡ ì¿¨ë‹¤ìš´
- [ ] 1ë¶„ ëŒ€ê¸° íƒ€ì´ë¨¸
- [ ] ì¹´ìš´íŠ¸ë‹¤ìš´ í‘œì‹œ
- [ ] ì¬ë°œì†¡ íšŸìˆ˜ ì œí•œ (3íšŒ/ì‹œê°„)

#### F-8: ë³´ì•ˆ ì•Œë¦¼
- [ ] ë¹„ë°€ë²ˆí˜¸ ë³€ê²½ ì™„ë£Œ ì´ë©”ì¼
- [ ] ë³¸ì¸ ì•„ë‹Œ ê²½ìš° ì¡°ì¹˜ ì•ˆë‚´

**ì•Œë¦¼ ì´ë©”ì¼ í…œí”Œë¦¿:**
```
ì œëª©: [Travel Planner] ë¹„ë°€ë²ˆí˜¸ê°€ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤

ì•ˆë…•í•˜ì„¸ìš”,

ê·€í•˜ì˜ ê³„ì • ë¹„ë°€ë²ˆí˜¸ê°€ ë°©ê¸ˆ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤.

ë³€ê²½ ì¼ì‹œ: 2025-10-05 12:34:56
IP ì£¼ì†Œ: 192.168.1.1
ë””ë°”ì´ìŠ¤: Chrome on Windows

ë³¸ì¸ì´ ë³€ê²½í•˜ì§€ ì•Šì•˜ë‹¤ë©´ ì¦‰ì‹œ ê³ ê°ì„¼í„°ë¡œ ì—°ë½ ì£¼ì„¸ìš”.
[ê³ ê°ì„¼í„° ë°”ë¡œê°€ê¸°]

ê³„ì • ë³´ì•ˆì„ ìœ„í•´ ì •ê¸°ì ìœ¼ë¡œ ë¹„ë°€ë²ˆí˜¸ë¥¼ ë³€ê²½í•˜ëŠ” ê²ƒì„ ê¶Œì¥í•©ë‹ˆë‹¤.
```

#### F-9: Rate Limiting
- [ ] IPë‹¹ ìš”ì²­ ì œí•œ (5íšŒ/ì‹œê°„)
- [ ] ì´ë©”ì¼ë‹¹ ìš”ì²­ ì œí•œ (3íšŒ/ì‹œê°„)
- [ ] ê³¼ë„í•œ ìš”ì²­ ì°¨ë‹¨ ë©”ì‹œì§€

### 3.3 ì¶”ê°€ ê¸°ëŠ¥ (Phase 3)

#### F-10: ë³´ì•ˆ ì§ˆë¬¸
- [ ] ì¶”ê°€ ì¸ì¦ ë‹¨ê³„
- [ ] ì‚¬ì „ ì„¤ì •í•œ ë³´ì•ˆ ì§ˆë¬¸ ë‹µë³€
- [ ] 2ë‹¨ê³„ ê²€ì¦

#### F-11: SMS ì¸ì¦
- [ ] ë¬¸ì ì¸ì¦ ì½”ë“œ ë°œì†¡
- [ ] 6ìë¦¬ ìˆ«ì ì½”ë“œ
- [ ] 5ë¶„ ìœ íš¨ê¸°ê°„

## 4. UI/UX ì‚¬ì–‘

### 4.1 ë ˆì´ì•„ì›ƒ

#### ì´ë©”ì¼ ì…ë ¥ í™”ë©´
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   â† ë’¤ë¡œê°€ê¸°         â”‚
â”‚                     â”‚
â”‚   ë¹„ë°€ë²ˆí˜¸ ì°¾ê¸°      â”‚
â”‚                     â”‚
â”‚  ë“±ë¡ëœ ì´ë©”ì¼ ì£¼ì†Œë¥¼  â”‚
â”‚  ì…ë ¥í•´ì£¼ì„¸ìš”        â”‚
â”‚                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ ì´ë©”ì¼        â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ ì¬ì„¤ì • ë§í¬   â”‚  â”‚
â”‚  â”‚   ë³´ë‚´ê¸°      â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                     â”‚
â”‚  ë¡œê·¸ì¸ í™”ë©´ìœ¼ë¡œ      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### ë°œì†¡ ì™„ë£Œ í™”ë©´
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     â”‚
â”‚      ğŸ“§             â”‚
â”‚                     â”‚
â”‚  ì´ë©”ì¼ì„ í™•ì¸í•´ì£¼ì„¸ìš” â”‚
â”‚                     â”‚
â”‚  u***@example.com   â”‚
â”‚  ìœ¼ë¡œ ì¬ì„¤ì • ë§í¬ë¥¼   â”‚
â”‚  ë°œì†¡í–ˆìŠµë‹ˆë‹¤        â”‚
â”‚                     â”‚
â”‚  ë©”ì¼ì´ ì˜¤ì§€ ì•Šì•˜ë‚˜ìš”? â”‚
â”‚  Â· ìŠ¤íŒ¸ ë©”ì¼í•¨ í™•ì¸   â”‚
â”‚  Â· 1ë¶„ í›„ ì¬ë°œì†¡ ê°€ëŠ¥ â”‚
â”‚                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ ì¬ë°œì†¡ (60ì´ˆ) â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                     â”‚
â”‚  ë¡œê·¸ì¸ í™”ë©´ìœ¼ë¡œ      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### ìƒˆ ë¹„ë°€ë²ˆí˜¸ ì„¤ì •
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   ìƒˆ ë¹„ë°€ë²ˆí˜¸ ì„¤ì •    â”‚
â”‚                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ ìƒˆ ë¹„ë°€ë²ˆí˜¸ ğŸ‘ â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘ ê°•í•¨     â”‚
â”‚                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ ë¹„ë°€ë²ˆí˜¸ í™•ì¸ â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                     â”‚
â”‚  âœ“ 8ì ì´ìƒ          â”‚
â”‚  âœ“ ì˜ë¬¸ í¬í•¨         â”‚
â”‚  âœ“ ìˆ«ì í¬í•¨         â”‚
â”‚                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ ì¬ì„¤ì • ì™„ë£Œ   â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4.2 ì¸í„°ë™ì…˜

#### ì¬ë°œì†¡ ë²„íŠ¼
- ì¿¨ë‹¤ìš´ ì¤‘: ë¹„í™œì„±í™” + ì¹´ìš´íŠ¸ë‹¤ìš´
- í™œì„±í™”: í´ë¦­ ê°€ëŠ¥
- ì¬ë°œì†¡ ì„±ê³µ: í† ìŠ¤íŠ¸ ì•Œë¦¼

#### ë¹„ë°€ë²ˆí˜¸ ê°•ë„
- ì‹¤ì‹œê°„ ê²€ì¦
- ê²Œì´ì§€ ë°” ì• ë‹ˆë©”ì´ì…˜
- ìš”êµ¬ì‚¬í•­ ì²´í¬ë¦¬ìŠ¤íŠ¸

### 4.3 ì ‘ê·¼ì„±
- ìŠ¤í¬ë¦° ë¦¬ë”: ìƒíƒœ ë©”ì‹œì§€ ì½ê¸°
- í‚¤ë³´ë“œ: Enterë¡œ ì œì¶œ
- í¬ì»¤ìŠ¤ ì¸ë””ì¼€ì´í„°
- ì—ëŸ¬: role="alert"

## 5. ê¸°ìˆ  ì‚¬ì–‘

### 5.1 í”„ë¡ íŠ¸ì—”ë“œ

#### ì»´í¬ë„ŒíŠ¸ êµ¬ì¡°
```typescript
// PasswordResetRequestScreen.tsx
interface PasswordResetRequestScreenProps {
  onSuccess: () => void;
}

// PasswordResetScreen.tsx
interface PasswordResetScreenProps {
  token: string;
  onSuccess: () => void;
}

interface ResetPasswordFormData {
  newPassword: string;
  confirmPassword: string;
}
```

#### íƒ€ì´ë¨¸ ê´€ë¦¬
```typescript
function useResendTimer(initialSeconds: number = 60) {
  const [seconds, setSeconds] = useState(initialSeconds);
  const [canResend, setCanResend] = useState(false);

  useEffect(() => {
    if (seconds > 0) {
      const timer = setTimeout(() => setSeconds(seconds - 1), 1000);
      return () => clearTimeout(timer);
    } else {
      setCanResend(true);
    }
  }, [seconds]);

  const reset = () => {
    setSeconds(initialSeconds);
    setCanResend(false);
  };

  return { seconds, canResend, reset };
}
```

### 5.2 ë°±ì—”ë“œ

#### API ì—”ë“œí¬ì¸íŠ¸
```typescript
// auth.controller.ts
@Controller('auth')
export class AuthController {
  @Post('request-password-reset')
  @HttpCode(200)
  async requestPasswordReset(@Body() dto: RequestPasswordResetDto) {
    return this.authService.requestPasswordReset(dto.email);
  }

  @Post('reset-password')
  @HttpCode(200)
  async resetPassword(@Body() dto: ResetPasswordDto) {
    return this.authService.resetPassword(dto.token, dto.newPassword);
  }
}

// request-password-reset.dto.ts
export class RequestPasswordResetDto {
  @IsEmail()
  email: string;
}

// reset-password.dto.ts
export class ResetPasswordDto {
  @IsString()
  token: string;

  @IsString()
  @MinLength(8)
  @Matches(/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)/)
  newPassword: string;
}
```

#### í† í° ìƒì„± ë° ê²€ì¦
```typescript
import { randomBytes } from 'crypto';

async generateResetToken(userId: string): Promise<string> {
  const token = randomBytes(32).toString('hex');

  await this.passwordResetRepository.save({
    userId,
    token,
    expiresAt: new Date(Date.now() + 60 * 60 * 1000), // 1ì‹œê°„
    used: false
  });

  return token;
}

async validateResetToken(token: string): Promise<string> {
  const resetRequest = await this.passwordResetRepository.findOne({
    where: { token, used: false }
  });

  if (!resetRequest) {
    throw new BadRequestException('ìœ íš¨í•˜ì§€ ì•Šì€ í† í°ì…ë‹ˆë‹¤');
  }

  if (new Date() > resetRequest.expiresAt) {
    throw new BadRequestException('ë§Œë£Œëœ í† í°ì…ë‹ˆë‹¤');
  }

  return resetRequest.userId;
}
```

## 6. ë°ì´í„° ëª¨ë¸

### 6.1 PasswordReset
```typescript
interface PasswordReset {
  id: string;
  userId: string;
  token: string;
  expiresAt: Date;
  used: boolean;
  usedAt?: Date;
  ipAddress: string;
  userAgent: string;
  createdAt: Date;
}
```

## 7. API ëª…ì„¸

### POST /api/auth/request-password-reset
ì¬ì„¤ì • ë§í¬ ìš”ì²­

**Request:**
```json
{
  "email": "user@example.com"
}
```

**Response 200:**
```json
{
  "message": "ë¹„ë°€ë²ˆí˜¸ ì¬ì„¤ì • ë§í¬ê°€ ì´ë©”ì¼ë¡œ ì „ì†¡ë˜ì—ˆìŠµë‹ˆë‹¤",
  "email": "u***@example.com"
}
```

### POST /api/auth/reset-password
ë¹„ë°€ë²ˆí˜¸ ì¬ì„¤ì •

**Request:**
```json
{
  "token": "abc123...",
  "newPassword": "NewSecurePass123!"
}
```

**Response 200:**
```json
{
  "message": "ë¹„ë°€ë²ˆí˜¸ê°€ ì„±ê³µì ìœ¼ë¡œ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤"
}
```

## 8. ì„±ëŠ¥ ìš”êµ¬ì‚¬í•­

### 8.1 ì‘ë‹µ ì‹œê°„
- ì¬ì„¤ì • ìš”ì²­: < 1ì´ˆ
- ì´ë©”ì¼ ë°œì†¡: < 3ì´ˆ (ë¹„ë™ê¸°)
- ë¹„ë°€ë²ˆí˜¸ ë³€ê²½: < 500ms

### 8.2 ì´ë©”ì¼ ë°œì†¡
- í ì‹œìŠ¤í…œ ì‚¬ìš©
- ì¬ì‹œë„: 3íšŒ
- ë°œì†¡ ì‹¤íŒ¨ ë¡œê¹…

## 9. ë³´ì•ˆ ê³ ë ¤ì‚¬í•­

### 9.1 í† í° ë³´ì•ˆ
- 256ë¹„íŠ¸ ëœë¤ í† í°
- 1ì‹œê°„ ìœ íš¨ê¸°ê°„
- 1íšŒìš© (ì‚¬ìš© í›„ ë¬´íš¨í™”)

### 9.2 Rate Limiting
- IPë‹¹: 5íšŒ/ì‹œê°„
- ì´ë©”ì¼ë‹¹: 3íšŒ/ì‹œê°„
- ì°¨ë‹¨ ì‹œ: 429 ì‘ë‹µ

### 9.3 ë¡œê¹…
- ëª¨ë“  ì¬ì„¤ì • ì‹œë„ ê¸°ë¡
- IP ì£¼ì†Œ, User-Agent ì €ì¥
- ì˜ì‹¬ìŠ¤ëŸ¬ìš´ íŒ¨í„´ ëª¨ë‹ˆí„°ë§

### 9.4 ì´ë©”ì¼ ì—´ê±° ë°©ì§€
- ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ì´ë©”ì¼ì—ë„ ì„±ê³µ ì‘ë‹µ
- íƒ€ì´ë° ê³µê²© ë°©ì§€ (ì‘ë‹µ ì‹œê°„ ì¼ì •)

## 10. í…ŒìŠ¤íŠ¸ ê³„íš

### 10.1 Unit í…ŒìŠ¤íŠ¸
```typescript
describe('PasswordReset', () => {
  it('í† í° ìƒì„± ë° ê²€ì¦', async () => {
    // í…ŒìŠ¤íŠ¸ ì½”ë“œ
  });

  it('ë§Œë£Œëœ í† í° ê±°ë¶€', async () => {
    // í…ŒìŠ¤íŠ¸ ì½”ë“œ
  });

  it('ì‚¬ìš©ëœ í† í° ì¬ì‚¬ìš© ë°©ì§€', async () => {
    // í…ŒìŠ¤íŠ¸ ì½”ë“œ
  });
});
```

### 10.2 E2E ì‹œë‚˜ë¦¬ì˜¤
1. ì •ìƒ ì¬ì„¤ì •: ì´ë©”ì¼ ì…ë ¥ â†’ ë§í¬ í´ë¦­ â†’ ë¹„ë°€ë²ˆí˜¸ ë³€ê²½ â†’ ë¡œê·¸ì¸
2. ë§Œë£Œëœ ë§í¬: ì—ëŸ¬ í™”ë©´ í‘œì‹œ
3. ì¬ë°œì†¡: ì¿¨ë‹¤ìš´ â†’ ì¬ë°œì†¡ ì„±ê³µ

## 11. í–¥í›„ ê°œì„ ì‚¬í•­

### 11.1 ë³´ì•ˆ ê°•í™”
- 2ë‹¨ê³„ ì¸ì¦ (2FA) í†µí•©
- ìƒì²´ ì¸ì¦
- ë””ë°”ì´ìŠ¤ ì¸ì¦

### 11.2 UX ê°œì„ 
- ë¹„ë°€ë²ˆí˜¸ ë³€ê²½ í›„ ìë™ ë¡œê·¸ì¸
- ë¹„ë°€ë²ˆí˜¸ ê´€ë¦¬ì í†µí•©

### 11.3 ì•Œë¦¼
- í‘¸ì‹œ ì•Œë¦¼
- ê³„ì • í™œë™ ë¡œê·¸
